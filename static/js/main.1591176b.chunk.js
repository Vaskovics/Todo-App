(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{18:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n(11),o=n.n(r),a=(n(16),n(17),n(18),n(5)),u=n(4),i=n(3),s=n.n(i),d=n(7),l=n(2),p=n(0),f="https://mate.academy/students-api";function b(e){return new Promise((function(t){setTimeout(t,e)}))}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c={method:t};return n&&(c.body=JSON.stringify(n),c.headers={"Content-Type":"application/json; charset=UTF-8"}),b(300).then((function(){return fetch(f+e,c)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var m,O=function(e){return j(e)},h=function(e,t){return j(e,"POST",t)},v=function(e,t){return j(e,"PATCH",t)},x=function(e){return j(e,"DELETE")},T=function(e){return x("/todos/".concat(e))},k=function(e,t){return v("/todos/".concat(e),t)};!function(e){e.none="",e.add="Unable to add a todo",e.delete="Unable to delete a todo",e.update="Unable to update a todo",e.empty="Title can't by empty",e.load="Unable to load todos"}(m||(m={}));var y,g=n(6),_=n.n(g),N=function(e){var t,n=e.errorType,r=e.changeErrorType,o=Object(c.useState)(!1),a=Object(l.a)(o,2),u=a[0],i=a[1];Object(c.useEffect)((function(){return u||(t=setTimeout((function(){i(!0),r(m.none)}),3e3)),function(){clearTimeout(t)}}),[]);return Object(p.jsxs)("div",{className:_()("notification","is-danger","is-light","has-text-weight-normal",{hidden:u}),children:[Object(p.jsx)("button",{type:"button",className:"delete",onClick:function(){i(!0)}}),n]})},w=function(e){var t=e.todos,n=e.updateTodoStatus,r=e.onDeleteTodo,o=e.loadingIds,i=e.tempTodo,f=e.updateTodoOnServer,b=e.updateLoadingStatus,j=e.updateTodosList,O=e.updateError,h=Object(c.useState)(null),v=Object(l.a)(h,2),x=v[0],T=v[1],k=Object(c.useState)(""),y=Object(l.a)(k,2),g=y[0],N=y[1],w=Object(c.useRef)(null),S=function(e){N(e.currentTarget.value)};Object(c.useEffect)((function(){w.current&&w.current.focus()}),[x]),Object(c.useEffect)((function(){x&&N(x.title)}),[x]);var E=function(){var e=Object(d.a)(s.a.mark((function e(n){var c,o,i,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Escape"===n.key&&T(null),"Enter"!==n.key&&"blur"!==n.type){e.next=30;break}if(n.preventDefault(),""===g.trim()||!x){e.next=29;break}if(g!==x.title){e.next=7;break}return T(null),e.abrupt("return");case 7:return c=t.map((function(e){return Object(a.a)({},e)})),o=Object(a.a)(Object(a.a)({},x),{},{title:g}),i=t.map((function(e){return e.id===x.id?o:e})),j(i),b([x.id]),T(null),e.prev=13,e.next=16,f(x.id,o);case 16:d=e.sent,j(Object(u.a)(t).map((function(e){return e.id===d.id?d:e}))),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(13),O(m.update),j(c);case 24:return e.prev=24,b([]),e.finish(24);case 27:e.next=30;break;case 29:if(x)try{r(x)}catch(s){O(m.delete)}case 30:case"end":return e.stop()}}),e,null,[[13,20,24,27]])})));return function(t){return e.apply(this,arguments)}}(),C=function(e){E(e)};return Object(p.jsx)("ul",{className:"todoapp__main",children:t.map((function(e){return Object(p.jsxs)("li",{className:_()("todo",{completed:e.completed}),children:[Object(p.jsx)("label",{className:"todo__status-label",children:Object(p.jsx)("input",{type:"checkbox",className:"todo__status",onClick:function(){return n(e)}})}),(null===x||void 0===x?void 0:x.id)===e.id?Object(p.jsx)("form",{children:Object(p.jsx)("input",{ref:w,type:"text",className:"todo__title-field",placeholder:"Empty todo will be deleted",value:g,onDoubleClick:function(){return T(e)},onChange:S,onKeyDown:E,onBlur:C})}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("span",{className:"todo__title",onDoubleClick:function(){return T(e)},children:e.title}),Object(p.jsx)("button",{type:"button",className:"todo__remove",onClick:function(){return r(e)},children:"\xd7"})]}),Object(p.jsxs)("div",{className:_()("modal","overlay",{"is-active":(null===i||void 0===i?void 0:i.id)===e.id||o.some((function(t){return e.id===t}))}),children:[Object(p.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(p.jsx)("div",{className:"loader"})]})]},e.id)}))})};!function(e){e.all="all",e.active="active",e.completed="completed"}(y||(y={}));var S=function(e){var t=e.onFilterAllTodos,n=e.onFilterActiveTodos,c=e.onFilterCompletedTodos,r=e.onClearCompleted,o=e.selectedFilter,a=e.activeTodos,u=e.todos.filter((function(e){return e.completed})).length;return Object(p.jsxs)("footer",{className:"todoapp__footer",children:[Object(p.jsx)("span",{className:"todo-count",children:"".concat(a," item").concat(1!==a?"s":""," left")}),Object(p.jsxs)("nav",{className:"filter",children:[Object(p.jsx)("a",{href:"#/",className:_()("filter__link",{selected:o===y.all}),onClick:t,children:"All"}),Object(p.jsx)("a",{href:"#/active",className:_()("filter__link",{selected:o===y.active}),onClick:n,children:"Active"}),Object(p.jsx)("a",{href:"#/completed",className:_()("filter__link",{selected:o===y.completed}),onClick:c,children:"Completed"})]}),Object(p.jsx)("button",{type:"button",className:_()("todoapp__clear-completed",{"hide-btn":!u}),onClick:r,children:"Clear completed"})]})},E=function(e){var t=e.todos,n=e.loadingIds,r=e.updateTodos,o=e.updateError,i=e.postNewTodo,s=e.addTempTodo,d=e.updateLoadingStatus,f=Object(c.useRef)(null),b=Object(c.useState)(""),j=Object(l.a)(b,2),O=j[0],h=j[1],v=Object(c.useState)(!1),x=Object(l.a)(v,2),T=x[0],y=x[1];Object(c.useEffect)((function(){y(t.every((function(e){return e.completed})))}),[t]);return Object(c.useEffect)((function(){f.current&&t.length&&f.current.focus()}),[t.length,n]),Object(p.jsxs)("header",{className:"todoapp__header",children:[t.length>0&&Object(p.jsx)("button",{type:"button",className:"todoapp__toggle-all active",onClick:function(){var e=[],n=t.map((function(t){d((function(e){return[].concat(Object(u.a)(e),[t.id])}));var n=Object(a.a)(Object(a.a)({},t),{},{completed:!T});return e.push(k(n.id,n)),n}));Promise.all(e).then((function(e){r(e)})).catch((function(){o(m.update)})).finally((function(){d([])})),y(!T),r(n)}}),Object(p.jsx)("form",{onSubmit:function(e){return e.preventDefault()},children:Object(p.jsx)("input",{ref:f,disabled:n.length>0,type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?",value:O,onChange:function(e){h(e.target.value)},onKeyDown:function(e){if("Enter"===e.key)if(O.trim()){var t={completed:!1,id:+Math.random().toString().slice(-5),userId:10632,title:O};d(Object(u.a)(n)),s(Object(a.a)(Object(a.a)({},t),{},{id:0})),h(""),i(t)}else o(m.add)}})})]})},C=10632,D=function(){var e=Object(c.useState)([]),t=Object(l.a)(e,2),n=t[0],r=t[1],o=Object(c.useState)(m.none),i=Object(l.a)(o,2),f=i[0],b=i[1],j=Object(c.useState)(y.all),v=Object(l.a)(j,2),x=v[0],g=v[1],_=Object(c.useState)(null),D=Object(l.a)(_,2),F=D[0],I=D[1],L=Object(c.useState)([]),A=Object(l.a)(L,2),P=A[0],U=A[1],J=Object(c.useMemo)((function(){return n.reduce((function(e,t){return t.completed?e:e+1}),0)}),[n]);Object(c.useEffect)((function(){(function(){var e=Object(d.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("/todos?userId=".concat(C));case 3:t=e.sent,r(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),b(m.load);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]);var B=function(){var e=Object(d.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U((function(e){return[].concat(Object(u.a)(e),[t.id])})),e.prev=1,e.next=4,c=t,h("/todos?userId=".concat(C),c);case 4:n=e.sent,r((function(e){return[].concat(Object(u.a)(e.filter((function(e){return e.id}))),[n])})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),b(m.add),r((function(e){return e.filter((function(e){return e.id}))}));case 12:return e.prev=12,U([]),I(null),e.finish(12);case 16:case"end":return e.stop()}var c}),e,null,[[1,8,12,16]])})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(d.a)(s.a.mark((function e(t){var c,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U((function(e){return[].concat(Object(u.a)(e),[t.id])})),e.next=3,Promise.all(n.map(function(){var e=Object(d.a)(s.a.mark((function e(n){var o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.id!==t.id){e.next=16;break}return c=Object(a.a)(Object(a.a)({},n),{},{completed:!n.completed}),e.prev=2,e.next=5,k(c.id,c);case 5:o=e.sent,r((function(e){return[].concat(Object(u.a)(e.filter((function(e){return e.id!==t.id}))),[o])})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),b(m.update);case 12:return e.prev=12,U([]),e.finish(12);case 15:return e.abrupt("return",c);case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,null,[[2,9,12,15]])})));return function(t){return e.apply(this,arguments)}}()));case 3:o=e.sent,r(o);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(d.a)(s.a.mark((function e(){var t,c,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.filter((function(e){return!e.completed})),c=[],e.prev=2,o=n.filter((function(e){return e.completed})).map((function(e){return c.push(e.id),T(e.id)})),U(c),e.next=7,Promise.all(o);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),b(m.delete);case 12:r(t),U([]);case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),R=function(e){U([].concat(Object(u.a)(P),[e.id])),T(e.id).then((function(t){t||b(m.delete),r(Object(u.a)(n.filter((function(t){return t.id!==e.id})))),I(null),U([])}))},G=Object(u.a)(n).filter((function(e){switch(x){case y.active:return!e.completed;case y.completed:return e.completed}return e})),H=function(e){b(e)},W=function(e){r(e)};return Object(p.jsxs)("div",{className:"todoapp",children:[Object(p.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(p.jsxs)("div",{className:"todoapp__content",children:[Object(p.jsx)(E,{todos:n,loadingIds:P,updateTodos:W,updateError:H,postNewTodo:B,addTempTodo:I,updateLoadingStatus:U}),Object(p.jsx)(w,{todos:G,updateTodoStatus:K,onDeleteTodo:R,loadingIds:P,tempTodo:F,updateTodoOnServer:k,updateLoadingStatus:U,updateTodosList:W,updateError:H}),F&&Object(p.jsx)(w,{todos:[F],updateTodoStatus:K,onDeleteTodo:R,loadingIds:P,tempTodo:F,updateTodoOnServer:k,updateLoadingStatus:U,updateTodosList:W,updateError:H}),n.length>0&&Object(p.jsx)(S,{onFilterAllTodos:function(){g(y.all)},onFilterActiveTodos:function(){g(y.active)},onFilterCompletedTodos:function(){g(y.completed)},onClearCompleted:M,selectedFilter:x,activeTodos:J,todos:n})]}),f&&Object(p.jsx)(N,{errorType:f,changeErrorType:H})]})};o.a.render(Object(p.jsx)(D,{}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.1591176b.chunk.js.map